{% extends "global/Page.html" %}
{% load otree static %}

{% block title %}
    First round: Results
{% endblock %}

{% block styles %}
    {% if player.wtp_treatment %}
        <link rel="stylesheet" href="{% static "noa_shared/bootstrap-slider.min.css" %}"/>
        <link rel="stylesheet" href="{% static "noa_shared/agent.css" %}">
    {% endif %}
{% endblock %}

{% block content %}
    <div align="center">
        <img src="{% static 'noa_shared/room_diagram_first_round.png' %}" height="150">
    </div>
    <p>
        Your action was <b>{{ own_action }}</b>.
    </p>
    {% if player.nc_treatment %}
        <p>
            Based on
            <ul>
                <li>the urn draw,</li>
                <li>your own action, and</li>
                <li>your co-player's action,</li>
            </ul>
            you earned <b>{{ player.game_payoff }}</b> if this room is selected for payment.
        </p>
    {% else %}
        <p>
            Your co-player's action was <b>{{ others_action }}</b>.<br>
            The ball drawn from the urn was <b>{{ ball_color }}</b>.
        </p>
        <p>
            As a result you earned <b>{{ player.game_payoff }}</b> if this room is selected for payment.
        </p>
    {% endif %}

    {% if player.wtp_treatment %}
        <p>
            Before you proceed to the second round, you can find out which action your co-player took and the color of the ball that was drawn. 
        </p>
        <p>
            Please set the slider below between $0.00 and $0.50 to state how much you are willing to pay at most for finding out. 
        </p>
        <p>
            Your interests are best served by setting the slider truthfully (see here for details). The amount you set on the slider will be deducted from your bonus only if you find out the action of your co-player and the urn draw.
        </p>
        <p>
            How many cents at most are you willing to pay to find out which action your co-player took and the color of the ball that was drawn?  
        </p>
        
        <table cellspacing="0" class="slider-layout" width="%">
        <tr>
            <td align="right" width="250">
                $0.00
            </td>
            <td align="center" width="410">
                <input id="id_wtp_payment" name="wtp_payment" type="text" data-slider-min="0.00" data-slider-max="0.50" data-slider-step="0.01" data-slider-value="0.25"/>
            </td>
            <td align="left" width="250">
               $0.50
            </td>
        </tr>
    </table>
        <p style="text-align: center;">$<span id="wtp"></span></p>
        
    {% endif %}
    <p>Please click ‘next’ to continue. {% if player.wtp_treatment %}The button appears after you have set the slider.{% endif %}</p>
    {% next_button %}
{% endblock %}

{% block scripts %}
    {% if player.wtp_treatment %}
        <script src="{% static "noa_shared/bootstrap-slider.min.js" %}"></script>
        <script type="text/javascript">
            $("#id_wtp_payment").slider();
            $('.otree-btn-next').hide();
            $('.slider-handle').hide();
            $('.slider').on('mousedown', function (event) {
                $(this).find('.slider-handle:not(.hide)').show();
                $('.otree-btn-next').show();
            });
            $('.slider').on('change', function(event) {
                let v = parseFloat($('#id_wtp_payment').val());
                $('#wtp').text(v.toFixed(2)); 
            });
        </script>
    {% endif %}
{% endblock %}

